<div class="mb-6 rounded-lg border bg-white p-4 shadow-sm">
  <form method="get" action="/budget" class="grid gap-3 md:grid-cols-6">
    {% set f = filters if filters is mapping else {} %}

    <div class="md:col-span-1">
      <label class="block text-xs font-medium text-gray-700">Type</label>
      <select name="type" class="mt-1 w-full rounded-md border px-3 py-2 text-sm">
        <option value="" {% if not f.get("type") %}selected{% endif %}>(all)</option>
        <option value="expense" {% if f.get("type") == "expense" %}selected{% endif %}>expense</option>
        <option value="income" {% if f.get("type") == "income" %}selected{% endif %}>income</option>
      </select>
    </div>

    <div class="md:col-span-1">
      <label class="block text-xs font-medium text-gray-700">Schedule</label>
      <select name="schedule" class="mt-1 w-full rounded-md border px-3 py-2 text-sm">
        <option value="" {% if not f.get("schedule") %}selected{% endif %}>(all)</option>
        <option value="one-time" {% if f.get("schedule") == "one-time" %}selected{% endif %}>one-time</option>
        <option value="recurring" {% if f.get("schedule") == "recurring" %}selected{% endif %}>recurring</option>
      </select>
    </div>

    <div class="md:col-span-2">
      <label class="block text-xs font-medium text-gray-700">Category</label>
      <select
        name="category_id"
        id="f_category_id"
        class="mt-1 w-full rounded-md border px-3 py-2 text-sm"
        hx-get="/budget/subcategories"
        hx-trigger="change"
        hx-target="#f_subcategory_id"
        hx-include="#f_category_id"
      >
        <option value="" {% if not f.get("category_id") %}selected{% endif %}>(all)</option>
        {% for c in categories %}
          <option value="{{ c.id }}" {% if f.get("category_id") == (c.id|string) %}selected{% endif %}>
            {{ (c.icon ~ ' ' if c.icon else '') ~ c.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="md:col-span-2">
      <label class="block text-xs font-medium text-gray-700">Subcategory</label>
      <select name="subcategory_id" id="f_subcategory_id" class="mt-1 w-full rounded-md border px-3 py-2 text-sm">
        <option value="" {% if not f.get("subcategory_id") %}selected{% endif %}>(all)</option>
      </select>
    </div>

    <div class="md:col-span-6 flex items-end gap-2">
      <button type="submit" class="rounded-md bg-black px-3 py-2 text-sm text-white">Apply</button>
      <a href="/budget" class="rounded-md border px-3 py-2 text-sm">Reset</a>
    </div>
  </form>
</div>
